
#Описание алгоритма
1. Twofish
Twofish — итеративный блоковый алгоритм с длиной информационного блока 128 бит.
Длина используемого ключа — 128, 192 или 256 бит. В основе данного алгоритма
лежит сеть Файстела. Отличительной особенностью является наличие циклических
сдвигов. Количество раундов — 16. На вход алгоритма подается 128 бит данных. Эти
данные разделяются на 4 блока по 32 бита. Затем они складываются по модулю два с
четырьмя 32-битными ключами. Данная процедура называется входным отбеливанием
(input whitening). Далее эти данные попадают в цикл преобразований, длящийся 16
раундов, где два левых слова (по 32 бита каждое) подаются на вход функции F.
Результаты преобразований складываются по модулю два с правыми словами. Правые
и левые части меняются местами, и происходит еще 15 раундов. В заключение
производится дополнительная перестановка, а на выходе данные складываются по
модулю два с 32-битными ключами (выходное отбеливание или output whitening).

2. Функция F — 64-битная перестановка, зависящая от ключа. Аргументы ее — два
32-битных слова R0 и R1 и номер раунда r, который определяет выбор подключей. R0
подвергается преобразованию, определяемому функцией g, результатом является блок
T0. R1 сначала сдвигается на 8 бит влево, а затем также преобразуется в функции g,
результатом является блок T1. Далее T0 и T1 трансформируются с помощью
псевдоадаморова преобразования (ПАП или PHT — Pseudo-Hadamar Transform) и
складываются по модулю 232 с соответствующими блоками ключа, которые
определяются номером раунда. Результатом функции F будут являться блоки F0 и F1.

3. Преобрзование g Данное преобразование является «сердцем» алгоритма Twofish. Исходный 32-битный
блок делится на четыре байта. Далее каждый байт подвергается преобразованию в
соответствующей S-Box, на выходе которого также 8-битный блок. 

4. Генерация ключей
Процедура генерации ключей обеспечивает создание 40 слов расширенного ключа и
четырех зависимых от ключа S-Box, используемых в функции g. Если длина введенного
ключа не совпадает с одним из трех возможных, то ключ дополняется до ближайшего
нулевыми битами.
Исходный ключ делится на равные части по 8 байт. Каждая часть умножается на
фиксированную матрицу, полученную из порождающей матрицы помехоустойчивого
кода Рида-Соломона над GF(28) 

5. Перестановки q0 и q1
 q0 и q1 — фиксированные перестановки 8 битов входного байта x.
